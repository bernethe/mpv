"use strict";var _data,_currCat;!function(e,t){function a(e){var t=document.getElementById("dynamicContent");t.removeChild(document.querySelector("#dynamicContent .row")),t.appendChild(p("div",{class:"row text-center head-cat"},[p("div",{class:"col-sm-12"},[p("h2",{},[_data.categories[_currCat].label]),p("p",{},[_data.categories[_currCat].descript]),p("small",{class:"nota-cat"},[p("strong",{},["OJO"]),": si usted no se encuentra en la lista, es porque no se puede votar por uno mismo, pero estese tranquilo, que los demás si pueden votar por usted."]),p("div",{},[p("a",{href:"#",id:"go_to_cats"},["{ Regresar a las categorías }"])])])]));var a=p("div",{class:"face-selector"});_data.users.map(function(e,t){if(0==_data.categories[_currCat].sex&&0==_data.categories[_currCat].department||_data.categories[_currCat].sex==e.sex&&0==_data.categories[_currCat].department||0==_data.categories[_currCat].sex&&_data.categories[_currCat].department==e.department||_data.categories[_currCat].sex==e.sex&&_data.categories[_currCat].department==e.department){var o=p("input",{type:"radio",name:"gente",value:e.id});o.addEventListener("change",function(){document.querySelector(".btn-latres").classList.remove("hidden")},!1),a.appendChild(p("label",{},[o,p("div",{},[p("img",{src:"https://graph.facebook.com/"+e.fb+"/picture?type=large",alt:e.name,class:"img-responsive"}),p("span",{},[e.name])])]))}}),t.appendChild(a),t.appendChild(p("div",{class:"row text-center submit-vote"},[p("button",{id:"votar_btn",class:"btn btn-primary btn-latres btn-lg hidden",type:"button"},["VOTAR"])])),document.getElementById("go_to_cats").addEventListener("click",s,!1),document.getElementById("votar_btn").addEventListener("click",r,!1)}var o=function e(t){_currCat=0,i("Cargando Usuarios");var a=new FormData;a.append("show","users"),a.append("cache",Date.now()),axios.post("/api/",a).then(function(e){_data=e.data,_data.map(function(e){return document.querySelector("#user").appendChild(p("option",{value:e.id},[e.name]))}),document.querySelector("#form_login").addEventListener("submit",n,!1),l()}).catch(function(e){u(e,"ERROR")})},n=function e(t){if(t.preventDefault(),3!=document.querySelector("#password").value.length)u("Para ingresar debe ingresar los últimos <strong>3 dígitos</strong> de la cédula.","ERROR");else{i("Autenticando Ingreso");var a=new FormData(document.getElementById("form_login"));a.append("cache",Date.now()),axios.post("/api/",a).then(function(e){_data=e.data,l(),d(),document.querySelector("#nav_pos").appendChild(p("div",{class:"user_row"},[p("small",{},["Bienvenid@ "]),p("strong",{},[_data.me.name])," | ",p("small",{},[p("a",{href:"#",id:"logout_link"},["desconectar"])])])),document.getElementById("logout_link").addEventListener("click",function(e){e.preventDefault(),location.reload()},!1)}).catch(function(e){u(e,"ERROR")})}},d=function e(){var t=p("ul",{class:"list-unstyled cat-selector"});_data.categories.map(function(e,a){var o=void 0;o=0==e.vote?p("li",{"data-cid":e.id,"data-ic":a,class:"cat-enabled"},[e.label]):p("li",{"data-cid":e.id,"data-ic":a,class:"cat-disabled"},[e.label]),o.addEventListener("click",c,!1),t.appendChild(o)});for(var a=document.getElementById("dynamicContent");a.firstChild;)a.removeChild(a.firstChild);a.appendChild(p("div",{class:"row"},[p("div",{class:"col-sm-4 col-sm-offset-4 cat-container"},[p("h4",{},["Categorías"]),p("hr"),t])]))},c=function e(t){if(0==_data.categories[t.target.dataset.ic].vote)_currCat=t.target.dataset.ic,document.querySelector(".cat-container").classList.add("cat-container-hidder"),setTimeout(a,1e3);else{var o="a";1==_data.me.sex&&(o="o"),u("No juegue de loc"+o+", usted ya votó en esta categoría.","YA VOTÓ")}},r=function e(t){if(document.querySelector("input[type=radio]:checked")){i("Guardando Voto...");var a=new FormData;a.append("show","vote"),a.append("category",_data.categories[_currCat].id),a.append("vote",document.querySelector("input[type=radio]:checked").value),a.append("user",_data.me.id),a.append("cache",Date.now()),axios.post("/api/",a).then(function(e){console.log(e),_data.categories=e.data,l(),s()}).catch(function(e){u(e,"ERROR")})}},s=function e(t){t&&t.preventDefault(),_currCat=0,document.querySelector(".head-cat").classList.add("head-cat-go"),document.querySelector(".face-selector").classList.add("face-selector-go"),setTimeout(d,800)},i=function e(t){var a=p("div",{},[p("div",{class:"spinner_mc"}),p("div",{class:"status_sp_txt"},[t])]),o=p("div",{class:"modal-pl"},[a]);document.querySelector(".container").classList.add("modal-pl-body"),document.body.appendChild(o)},l=function e(t){t&&t.preventDefault(),document.body.removeChild(document.querySelector(".modal-pl")),document.querySelector(".container").classList.remove("modal-pl-body")},u=function e(t,a,o){var n=new Array;void 0!=a&&n.push(p("div",{class:"modal_header"},[p("h3",{},[a])])),n.push(p("div",{class:"modal_body"},[t])),void 0!=o&&n.push(p("div",{class:"modal_footer"},[o])),n.push(p("a",{href:"#",class:"modal_close"},["×"]));var d=p("div",{class:"modalAll"},n),c=p("div",{id:"modalDialog"},[d]);c.addEventListener("click",function(e){e.target===c&&m()}),document.body.appendChild(c),document.querySelector(".modal_close").addEventListener("click",m),document.querySelector(".container").classList.add("modal-pl-body")},m=function e(t){t&&t.preventDefault(),document.body.removeChild(document.getElementById("modalDialog")),document.querySelector(".container").classList.remove("modal-pl-body")},p=function e(t,a,o){var n=document.createElement(t);return void 0!==o&&o.forEach(function(e){e.nodeType?1!==e.nodeType&&11!==e.nodeType||n.appendChild(e):n.innerHTML+=e}),v(n,a),n},v=function e(t,a){for(var o in a)a.hasOwnProperty(o)&&t.setAttribute(o,a[o])};document.addEventListener("DOMContentLoaded",o,!1)}(window);